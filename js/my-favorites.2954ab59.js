(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["my-favorites"],{fd4f:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"my-favorites"},[r("b-container",[r("b-row",[r("b-col",{staticClass:"mx-auto mb-4",attrs:{cols:"12",lg:"10"}},[r("h2",{staticClass:"my-favorites__title"},[t._v(t._s(t.favoritesTitle))])]),r("b-col",{staticClass:"mx-auto",attrs:{cols:"12",lg:"10"}},t._l(t.favoritesArticles,(function(e){return r("div",{key:e._id,staticClass:"articles-item"},[r("h2",{staticClass:"articles-item__title",on:{click:function(r){return t.toArticle(e)}}},[t._v(t._s(e.title))]),r("div",{staticClass:"articles-item__info"},[e.isBlocked?r("span",{staticClass:"tag tag--blocked no-hover"},[t._v("文章已被封鎖")]):t._e(),r("b-avatar",{staticClass:"articles-item__avatar",attrs:{src:e.author.photoUrl,size:"1.4rem",rounded:"sm",to:"/blog/"+e.author._id}}),r("span",{staticClass:"articles-item__author-name"},[t._v(t._s(e.author.username))]),r("span",{staticClass:"articles-item__favorites-count"},[t._v(t._s("，有 "+e.favorites.length+" 人收藏此文章"))]),r("b-dropdown",{staticClass:"articles-item__dropdown",attrs:{variant:"link","no-caret":"",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[r("font-awesome-icon",{staticClass:"icon articles-item__icon",attrs:{icon:["fas","chevron-down"],"fixed-width":""}})]},proxy:!0}],null,!0)},[r("b-dropdown-item",{staticClass:"dropdown--danger",on:{click:function(r){return t.unFavorites(e)}}},[t._v("從收藏文章中刪除")])],1)],1)])})),0)],1)],1)],1)},a=[],i=(r("4de4"),r("caad"),r("d81d"),r("2532"),r("96cf"),r("1da1")),n=r("c44e"),o=r("6608"),c={name:"MyFavorites",components:{HorizontalArticleCard:n["a"]},data:function(){return{articles:[]}},computed:{user:function(){return this.$store.state.user},favoritesArticles:function(){var t=this;return this.articles.filter((function(e){return e.favorites.includes(t.user.id)}))},favoritesTitle:function(){return 0===this.favoritesArticles.length?"你還沒有收藏的文章":"你收藏的文章"}},methods:{filterPublished:function(t){return t.filter((function(t){var e=t.isPublished,r=t.isDraft,s=(t.isBlocked,t.isUnlisted);return e&&!r&&!s})).map((function(t){return t.createDate=Object(o["a"])(t.createDate,!0),t.title=t.title?t.title:"Untitled",t}))},toArticle:function(t){t.isBlocked||this.$router.push("/article/"+t._id)},unFavorites:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,a,i,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$bvModal.msgBoxConfirm("你確定不要繼續收藏「".concat(t.title,"」了嗎?"),{title:"從收藏文章中刪除",size:"md",buttonSize:"sm",okVariant:"danger",okTitle:"確定",cancelTitle:"取消",hideHeaderClose:!0,centered:!0,headerClass:"border-bottom-0 justify-content-center",bodyClass:"text-center",footerClass:"border-top-0 justify-content-center"});case 3:if(s=r.sent,s){r.next=6;break}return r.abrupt("return");case 6:return r.next=8,e.axios.patch("https://cuishare.herokuapp.com/articles/favorites/"+t._id);case 8:a=r.sent,i=a.data,n=i.success,o=i.result,n&&(t.favorites=o.favorites),r.next=16;break;case 13:r.prev=13,r.t0=r["catch"](0),alert(r.t0.response.data.message);case 16:case"end":return r.stop()}}),r,null,[[0,13]])})))()}},mounted:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var r,s,a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.$loading.show(),e.prev=1,e.next=4,t.axios.get("https://cuishare.herokuapp.com/articles");case 4:s=e.sent,a=s.data,i=a.success,n=a.result,i&&(t.articles=t.filterPublished(n)),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log(e.t0);case 12:r.hide();case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}},l=c,u=r("2877"),d=Object(u["a"])(l,s,a,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=my-favorites.2954ab59.js.map