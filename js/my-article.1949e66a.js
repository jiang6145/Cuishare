(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["my-article"],{a741:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"my-article"},[i("b-container",[i("b-row",[i("b-col",{staticClass:"mx-auto mb-4 my-article__col",attrs:{cols:"12",lg:"10"}},[i("h2",{staticClass:"my-article__title"},[t._v("你的文章")]),i("b-button",{staticClass:"custom-btn",attrs:{variant:"success",size:"sm"},on:{click:t.createArticle}},[t._v("寫文章")])],1)],1),i("b-row",[i("b-col",{staticClass:"mx-auto",attrs:{cols:"12",lg:"10"}},[i("b-tabs",{attrs:{value:t.myArticleTabIndex},on:{input:t.onInput}},[i("b-tab",{staticClass:"articles-list",attrs:{title:"草稿 "+t.draft.length}},t._l(t.draft,(function(e){return i("div",{key:e._id,staticClass:"articles-list__item"},[i("h2",{staticClass:"articles-list__title",on:{click:function(i){return t.toArticle(e)}}},[t._v(t._s(e.title))]),e.isBlocked?i("span",{staticClass:"tag tag--blocked no-hover"},[t._v("文章已被封鎖")]):t._e(),i("span",{staticClass:"articles-list__info"},[t._v(t._s("創建於 "+e.createDate))]),i("b-dropdown",{staticClass:"articles-list__dropdown",attrs:{variant:"link","no-caret":"",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("font-awesome-icon",{staticClass:"icon articles-list__icon",attrs:{icon:["fas","chevron-down"],"fixed-width":""}})]},proxy:!0}],null,!0)},[i("b-dropdown-item",{on:{click:function(i){return i.preventDefault(),t.editArticle(e)}}},[t._v("編輯文章")]),i("b-dropdown-item",{staticClass:"dropdown--danger",on:{click:function(i){return t.deleteArticle(e)}}},[t._v("刪除文章")])],1)],1)})),0),i("b-tab",{staticClass:"articles-list",attrs:{title:"已發佈 "+t.published.length}},t._l(t.published,(function(e){return i("div",{key:e._id,staticClass:"articles-list__item"},[i("h2",{staticClass:"articles-list__title",on:{click:function(i){return t.toArticle(e)}}},[t._v(t._s(e.title))]),e.isBlocked?i("span",{staticClass:"tag tag--blocked no-hover"},[t._v("文章已被封鎖")]):t._e(),i("span",{staticClass:"articles-list__info"},[t._v(t._s(e.info))]),i("b-dropdown",{staticClass:"articles-list__dropdown",attrs:{variant:"link","no-caret":"",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("font-awesome-icon",{staticClass:"icon articles-list__icon",attrs:{icon:["fas","chevron-down"],"fixed-width":""}})]},proxy:!0}],null,!0)},[i("b-dropdown-item",{on:{click:function(i){return i.preventDefault(),t.editArticle(e)}}},[t._v("編輯文章")]),i("b-dropdown-item",{staticClass:"dropdown--danger",on:{click:function(i){return t.deleteArticle(e)}}},[t._v("刪除文章")])],1)],1)})),0),i("b-tab",{staticClass:"articles-list",attrs:{title:"未公開 "+t.unlisted.length}},t._l(t.unlisted,(function(e){return i("div",{key:e._id,staticClass:"articles-list__item"},[i("h2",{staticClass:"articles-list__title",on:{click:function(i){return t.toArticle(e)}}},[t._v(t._s(e.title))]),e.isBlocked?i("span",{staticClass:"tag tag--blocked no-hover"},[t._v("文章已被封鎖")]):t._e(),i("span",{staticClass:"articles-list__info"},[t._v(t._s("創建於 "+e.createDate))]),i("b-dropdown",{staticClass:"articles-list__dropdown",attrs:{variant:"link","no-caret":"",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("font-awesome-icon",{staticClass:"icon articles-list__icon",attrs:{icon:["fas","chevron-down"],"fixed-width":""}})]},proxy:!0}],null,!0)},[i("b-dropdown-item",{on:{click:function(i){return i.preventDefault(),t.editArticle(e)}}},[t._v("編輯文章")]),i("b-dropdown-item",{staticClass:"dropdown--danger",on:{click:function(i){return t.deleteArticle(e)}}},[t._v("刪除文章")])],1)],1)})),0)],1)],1)],1)],1)],1)},s=[],r=(i("99af"),i("4de4"),i("c740"),i("d81d"),i("a434"),i("96cf"),i("1da1")),a=i("6608"),c={name:"MyArticle",data:function(){return{articles:[]}},computed:{user:function(){return this.$store.state.user},myArticleTabIndex:function(){return this.$store.state.myArticleTabIndex},draft:function(){return this.articles.filter((function(t){var e=t.isDraft,i=t.isPublished,n=t.isUnlisted;return e&&!i&&!n}))},published:function(){return this.articles.filter((function(t){var e=t.isDraft,i=t.isPublished,n=t.isUnlisted;return!e&&i&&!n})).map((function(t){var e=t.likes.length>0?"，有 ".concat(t.likes.length," 人喜歡"):"",i=t.favorites.length>0?" ，有 ".concat(t.favorites.length," 人收藏"):"";return t.info="發布於 ".concat(t.publishedDate).concat(e).concat(i),t}))},unlisted:function(){return this.articles.filter((function(t){var e=t.isDraft,i=t.isPublished,n=t.isUnlisted;return!e&&i&&n}))}},methods:{createArticle:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i,n,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.post("https://cuishare.herokuapp.com/articles",{});case 3:i=e.sent,n=i.data,s=n.success,r=n.result,s&&t.$router.push("/article-edit/"+r._id),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},toArticle:function(t){if(t.isBlocked)return this.$toasted.error("此文章已被封鎖，不可閱讀");this.$router.push("/article/"+t._id)},editArticle:function(t){if(t.isBlocked)return this.$toasted.error("此文章已被封鎖，不可編輯");this.$router.push("/article-edit/"+t._id)},deleteArticle:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var n,s,r,a,c,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,e.$bvModal.msgBoxConfirm("你確定要刪除「".concat(t.title,"」嗎?"),{title:"刪除文章",size:"md",buttonSize:"sm",okVariant:"danger",okTitle:"刪除",cancelTitle:"取消",hideHeaderClose:!0,centered:!0,headerClass:"border-bottom-0 justify-content-center",bodyClass:"text-center",footerClass:"border-top-0 justify-content-center"});case 3:if(n=i.sent,n){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,e.axios.delete("https://cuishare.herokuapp.com/articles/"+t._id);case 8:s=i.sent,r=s.data,a=r.success,c=r.result,a&&(o=e.articles.findIndex((function(t){return t._id===c._id})),e.articles.splice(o,1)),i.next=16;break;case 13:i.prev=13,i.t0=i["catch"](0),console.log(i.t0);case 16:case"end":return i.stop()}}),i,null,[[0,13]])})))()},onInput:function(t){this.$store.commit("myArticleTabIndex",t)}},mounted:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i,n,s,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.$loading.show(),e.prev=1,e.next=4,t.axios.get("https://cuishare.herokuapp.com/articles/author/"+t.user.id);case 4:n=e.sent,s=n.data,r=s.success,c=s.result,r&&(t.articles=c.map((function(t){return t.createDate=Object(a["a"])(t.createDate),t.publishedDate=Object(a["a"])(t.publishedDate),t.title=t.title?t.title:"Untitled",t}))),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log(e.t0);case 12:i.hide();case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}},o=c,l=i("2877"),u=Object(l["a"])(o,n,s,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=my-article.1949e66a.js.map